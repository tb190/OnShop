@model OnShop.Models.ProductViewModel

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] - OnShop</title>
    <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/OnShop.styles.css" asp-append-version="true" />
    <link rel="stylesheet" href="https://maxst.icons8.com/vue-static/landings/line-awesome/line-awesome/1.3.0/css/line-awesome.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Sacramento&display=swap">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Montserrat&display=swap">
</head>
<body>
    <div class="All">
        <nav class="navbar navbar-expand-lg navbar-light">
            <div class="container">

                <div><img src="~/Pictures/logo.png" style="margin-left:-5px; border-radius:50px; width:70px; height:70px;"></div>

                <a class="navbar-brand  justify-content-flex-start" asp-area="" asp-controller="User" asp-action="UserHome" style="font-size: 2rem; color: #29353c; font-family: 'Sacramento', cursive;">OnShop</a>
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>




                <!-- Search Button -->
                <div class="container mb-2 col-md-6" style="margin-top:20px; margin-left: 210px;">
                    <form class="d-flex ">
                        <input class="form-control me-2 no-outline" type="search" placeholder="Search for Product..." aria-label="Search">
                        <button class="btn btn-outline-secondary" type="submit"><i class="las la-search"></i></button>
                    </form>
                </div>

                <div class="collapse navbar-collapse justify-content-end" id="navbarNav">
                    <ul class="navbar-nav" style="display: flex; align-items: center;">
                        <li class="nav-item" style=" margin-left: 15px; display: flex; flex-direction: row;">
                            <a class="nav-link" asp-area="" asp-controller="User" asp-action="FavoritedProducts">
                                <span class="lar la-heart" style="font-size: 22px;"></span>
                            </a>
                            <a class="nav-link" asp-area="" asp-controller="User" asp-action="UserBasket" style="position: relative;">
                                <span class="las la-shopping-cart" style="font-size: 22px;"></span>
                                <span id="basketCount" class="badge badge-danger position-relative" style="display: none; top: -10px; right:1px; "></span>
                            </a>

                            <a class="nav-link" asp-area="" asp-controller="User" asp-action="UserProfile">
                                <span class="las la-user" style="font-size: 22px;"></span>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>


        <!--  Category and Type Dropdowns -->
        <div class="container">
            <div class="category-bar">
                <ul class="nav justify-content-center">
                    <a class="nav-link category-navlink" asp-area="" asp-controller="User" asp-action="AllProducts" id="category-All" data-categoryid="">
                        All
                    </a>
                    @if (Model.Categories != null && Model.Categories.Count > 0)
                        {
                    @foreach (var category in Model.Categories)
                        {
                    <li class="nav-item" id="category-@category.CategoryId" data-categoryid="@category.CategoryId">
                        <a class="nav-link category-navlink" id="category-@category.CategoryId" data-categoryid="@category.CategoryId" asp-area="" asp-controller="User" asp-action="GetProductsByCategoryAndType" asp-route-category="@category.CategoryId" asp-route-type="">
                            @category.CategoryName
                        </a>
                        <div class="types-list" id="types-list-@category.CategoryId">
                            @if (category.Types != null && category.Types.Count > 0)
                            {
                            <div class="row">
                                @if(category.Types.Count<5){
                                <div class="col">
                                    <ul class="types">
                                        @for (int j = 0; j < Math.Min(category.Types.Count, 5); j++)
                                            {
                                        <li>
                                            <a class="nav-link" id="category-@category.Types[j]" data-categoryid="@category.Types[j]" asp-area="" asp-controller="User" asp-action="GetProductsByCategoryAndType" asp-route-category="@category.CategoryId" asp-route-type="@category.Types[j]">
                                                @category.Types[j]
                                            </a>
                                        </li>

                                            }
                                    </ul>
                                </div>
                                    }
                                    else{
                                        for (int i = 0; i < category.Types.Count/5; i++){
                                <div class="col">
                                    <ul class="types">
                                        @for (int j = 0; j < Math.Min(category.Types.Count, 5); j++)
                                                    {
                                        <li>
                                            <a class="nav-link" id="category-@category.Types[j]" data-categoryid="@category.Types[j] " asp-area="" asp-controller="User" asp-action="GetProductsByCategoryAndType" asp-route-category="@category.CategoryId" asp-route-type="@category.Types[j]">
                                                @category.Types[j]

                                            </a>
                                        </li>
                                                    }
                                    </ul>
                                </div>
                                        }
                                    }
                            </div>
                            }
                            else
                            {
                            <span class="text-danger">No types found for this category.</span>
                            }
                        </div>
                    </li>
                }
            }
            else
            {
                    <li class="nav-item">
                        <span class="nav-link text-danger">No categories found.</span>
                    </li>
            }
                </ul>
            </div>
        </div>





        <!-- Main content -->
        <main role="main" style="margin-bottom: 250px; margin-left: 100px; margin-right: 100px; margin-top: 20px;">
            @RenderBody()
        </main>





        <!-- Footer -->
        <footer class="footer">
            <div class="container">
                <div class="row">
                    <!-- Company Information -->
                    <div class="col-md-6 footer-about">
                        <h5>OnShop</h5>
                        <p>Welcome to OnShop, your premier online marketplace for businesses of all sizes. Showcase and sell your diverse range of products with ease. Join us today and elevate your business with our comprehensive ecommerce solutions.</p>
                        <ul class="footer-links">
                            <li><a href="#"></a></li>
                            <li><a href="#"></a></li>
                        </ul>
                    </div>

                    <!-- Contact Information -->
                    <div class="col-md-6 footer-contact" style="padding-left: 120px;">
                        <h5>Contact Information</h5>
                        <ul>
                            <li><i class="fas fa-envelope"></i> <a href="mailto:tbyurtturk@gmail.com">tbyurtturk@gmail.com</a></li>
                            <li><i class="fas fa-user"></i> Tanay Bensu Yurttürk</li>
                            <li><i class="fas fa-phone"></i> 0538 968 85 79</li>
                            <li><i class="fas fa-map-marker-alt"></i> Bahçelievler Mahallesi, Ata2 Sitesi, Mavi Çam Cd 25/9</li>
                        </ul>
                        <!-- Social Media Icons -->
                        <div class="footer-social-icons">
                            <i class="fab fa-facebook-f"></i>
                            <i class="fab fa-instagram"></i>
                            <i class="fab fa-twitter"></i>
                            <i class="fab fa-linkedin-in"></i>
                            <i class="fab fa-google"></i>
                        </div>
                    </div>
                </div>
            </div>
        </footer>
    </div>




    <script>
        // ------------------------------ cateogry or type or all ---------------------------------------------------
       /* $(document).ready(function () {
            // Function to handle the AJAX request
            function fetchProducts(category, type) {
                $.ajax({
                    url: '@Url.Action("GetProductsByCategoryAndType", "User")',
                    type: 'POST',
                    data: {
                        category: category,
                        type: type
                    }
                });
            }

            // Handle category clicks
            $('.category-navlink').click(function (e) {
                e.preventDefault();
                var categoryId = $(this).data('categoryid');
                fetchProducts(categoryId, null); // Fetch products by category
            });

            // Handle type clicks
            $('.types-list .nav-link').click(function (e) {
                e.preventDefault();
                var categoryId = $(this).closest('.types-list').attr('id').replace('types-list-', '');
                var type = $(this).data('categoryid');
                fetchProducts(categoryId, type); // Fetch products by category and type
            });

            // Optionally, you might want to handle the "All" button to show all products
            $('#category-All').click(function (e) {
                e.preventDefault();
                fetchProducts(null, null); // Fetch all products
            });
        });
        */

        // ---------------------------------------------------------------------------------
        $(document).ready(function () {
            $.getJSON('@Url.Action("GetBasketCount", "User")', function (data) {
                if (data > 0) {
                    $('#basketCount').text(data).show();
                } else {
                    $('#basketCount').hide();
                }
            });
        });

        // ---------------------------------------------------------------------------------

        $(document).ready(function () {
            // Hide all type lists initially
            $('.types-list').hide();

            var hoverTimeout;
            var showTimeout;
            var categoryId;
            var showListId;

            // Start showing the type list with a delay when hovering over a category
            $('.nav-link.category-navlink').mouseenter(function () {
                categoryId = $(this).data('categoryid');
                showListId = '#types-list-' + categoryId;

                // Clear any existing timeouts to prevent premature hiding
                clearTimeout(hoverTimeout);
                clearTimeout(showTimeout);

                // Set a timeout to show the type list after 2 seconds if mouse remains on the category
                showTimeout = setTimeout(function () {
                    // Hide all type lists first
                    $('.types-list').stop(true, true).slideUp();

                    // Show the current type list
                    $(showListId).stop(true, true).slideDown();
                }, 400); // 2 second delay
            });

            // If the mouse leaves the category before 2 seconds, clear the show timeout
            $('.nav-link.category-navlink').mouseleave(function () {
                clearTimeout(showTimeout);
            });

            // Keep the type list open when hovering over it
            $('.types-list').mouseenter(function () {
                // Clear any existing timeouts
                clearTimeout(hoverTimeout);
                clearTimeout(showTimeout);

                // Show the type list immediately
                $(this).stop(true, true).slideDown();
            });

            // Hide the type list when the mouse leaves it
            $('.types-list').mouseleave(function () {
                var $this = $(this);
                hoverTimeout = setTimeout(function () {
                    $this.stop(true, true).slideUp();
                }, 50); // Hide after 200ms delay
            });
        });

    </script>


    <style>

        .badge {
            font-size: 9px;
            padding: 0.5em 0.65em;
            border-radius: 50%;
            color: #fff;
            background-color: #dc3545; /* Red color */
        }

        .no-outline:focus {
            outline: none; /* Mavi outline'u kaldır */
            box-shadow: none; /* Box shadow'u kaldır */
        }

        .navbar {
            background-color: #fff;
        }

        .nav-link {
            display: block;
            color: #29353c;
            font-size: 0.7rem;
            padding-left: 1.4rem;
        }

        .navbar-nav .nav-item .nav-link {
            display: flex;
            align-items: center;
            padding-left: 20px;
        }

        .nav-link span:first-child {
            font-size: 0.9rem;
            color: #29353c;
            padding-right: 2px;
        }

        .nav-link .nav-text {
            font-family: 'Montserrat';
            font-size: 14px;
            color: #29353c;
        }

        .category-bar {
            background-color: #fff;
            border-bottom: 1px solid #29353c;
        }

            .category-bar .nav-link {
                color: #29353c;
                font-size: 14px;
                font-family: 'Montserrat', cursive;
                cursor: pointer;
            }

            .category-bar .category-navlink:hover {
                color: #fff;
                background-color: #29353c;
                border-radius: 5px;
            }

            .category-bar .dropdown-item {
                color: #29353c;
            }

        .types li a:hover {
            color: #768a96;
        }

        .types-list {
            display: none;
            /*position: absolute;*/
            background-color: #fff;
            width: max-content;
        }



        .All {
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        main {
            flex: 1;
        }

        .footer {
            border-top: 1px solid #768a96;
            padding: 40px 0;
            padding-bottom: 1px;
            color: #333;
            font-family: 'Montserrat', sans-serif;
            background-image: linear-gradient(to bottom, #f8f8f8, #f8f8f8, #f8f7f7, #f8f7f7, #f8f6f6, #f9f6f7, #f9f7f7, #faf7f8, #fbf9fa, #fcfbfc, #fdfdfe, #ffffff);
        }

            .footer h5 {
                font-size: 20px;
                font-weight: 600;
                color: #29353c;
                margin-bottom: 20px;
            }

            .footer p {
                font-size: 14px;
                color: #29353c;
                line-height: 1.6;
            }

            .footer a {
                color: #768a96;
                text-decoration: none;
                transition: color 0.3s ease;
            }

                .footer a:hover {
                    color: #29353c;
                }

            .footer ul {
                list-style: none;
                padding: 0;
            }

                .footer ul li {
                    margin-bottom: 10px;
                }

            .footer .footer-links li {
                margin-bottom: 5px;
            }

            .footer .footer-contact ul {
                margin-bottom: 20px;
            }

                .footer .footer-contact ul li {
                    display: flex;
                    align-items: center;
                }

                    .footer .footer-contact ul li i {
                        margin-right: 10px;
                        font-size: 18px;
                        color: #555;
                    }

            .footer .footer-social-icons {
                display: flex;
                gap: 10px;
                margin-top: 20px;
            }

                .footer .footer-social-icons i {
                    font-size: 20px;
                    color: #999;
                    cursor: pointer;
                    transition: color 0.3s ease;
                }

                    .footer .footer-social-icons i:hover {
                        color: #29353c;
                    }

    </style>

    <script src="~/lib/jquery/dist/jquery.min.js"></script>
    <script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script src="~/js/site.js" asp-append-version="true"></script>
    @await RenderSectionAsync("Scripts", required: false)
</body>
</html>
